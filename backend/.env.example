# =============================================================================
# PIXCRAWLER BACKEND ENVIRONMENT CONFIGURATION
# =============================================================================
# This file contains backend-specific configuration for the FastAPI application.
# Copy this file to .env and update with your values.
# Global settings should be in root .env file
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# Environment mode (development, staging, production)
ENVIRONMENT=development

# Enable debug mode (verbose errors, auto-reload)
# Set to 'false' in production
DEBUG=true

# Server host (empty for development, 0.0.0.0 for production)
HOST=

# Server port
PORT=8000

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Supabase Configuration
# -----------------------------------------------------------------------------
# Get these values from: https://app.supabase.com/project/_/settings/api

# Supabase project URL
SUPABASE_URL=https://your-project.supabase.co

# Service role key (bypasses RLS, use for backend admin operations)
# Security: Keep this secret! Never expose to browser!
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Anonymous key (for frontend, respects RLS)
SUPABASE_ANON_KEY=your-anon-key

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins
# Update with your frontend URL in production
ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# -----------------------------------------------------------------------------
# Database Configuration (Supabase PostgreSQL)
# -----------------------------------------------------------------------------
# PostgreSQL connection URL (asyncpg driver for async support)
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://postgres:password@db.your-project.supabase.co:5432/postgres

# Connection pool size (number of connections to maintain)
DATABASE_POOL_SIZE=10

# Maximum overflow connections beyond pool size
DATABASE_MAX_OVERFLOW=20

# -----------------------------------------------------------------------------
# Redis Configuration (Caching and Rate Limiting)
# -----------------------------------------------------------------------------
# Redis connection URL
# Use separate databases for different purposes (0=cache, 1=celery broker, 2=celery results)
REDIS_URL=redis://localhost:6379/0

# Cache expiration time in seconds (1 hour)
REDIS_EXPIRE_SECONDS=3600

# -----------------------------------------------------------------------------
# Celery Configuration (Task Queue)
# -----------------------------------------------------------------------------
# Celery broker URL (Redis database 1)
CELERY_BROKER_URL=redis://localhost:6379/1

# Celery result backend URL (Redis database 2)
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# -----------------------------------------------------------------------------
# File Upload Configuration
# -----------------------------------------------------------------------------
# Maximum upload file size in bytes (10MB = 10485760 bytes)
UPLOAD_MAX_SIZE=10485760

# Allowed file extensions (comma-separated)
UPLOAD_ALLOWED_EXTENSIONS=.jpg,.jpeg,.png,.gif,.webp

# -----------------------------------------------------------------------------
# Storage Provider Configuration
# -----------------------------------------------------------------------------
# Storage provider (local, azure)
# Use 'local' for development, 'azure' for production
STORAGE_PROVIDER=local

# Local storage path (for development)
STORAGE_LOCAL_PATH=./storage

# -----------------------------------------------------------------------------
# Azure Blob Storage Configuration (Optional)
# -----------------------------------------------------------------------------
# Configure these if using STORAGE_PROVIDER=azure

# Azure storage connection string
# Get from: Azure Portal → Storage Account → Access Keys
STORAGE_AZURE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=YOUR_ACCOUNT;AccountKey=YOUR_KEY;EndpointSuffix=core.windows.net

# Azure container name (will be created if it doesn't exist)
STORAGE_AZURE_CONTAINER_NAME=pixcrawler-storage

# Maximum retry attempts for Azure operations
STORAGE_AZURE_MAX_RETRIES=3

# Enable archive tier for cost optimization
# Set to 'true' to use warm storage (7z archives) for older datasets
STORAGE_AZURE_ENABLE_ARCHIVE_TIER=true

# Default storage tier (hot, cool, archive)
# hot: Immediate access, higher cost
# cool: Infrequent access, lower cost
# archive: Rare access, lowest cost (requires rehydration)
STORAGE_AZURE_DEFAULT_TIER=hot

# Rehydration priority when accessing archived data (standard, high)
STORAGE_AZURE_REHYDRATE_PRIORITY=standard

# -----------------------------------------------------------------------------
# Azure Lifecycle Management (Optional)
# -----------------------------------------------------------------------------
# Automated tier transitions to optimize costs

# Enable lifecycle management
STORAGE_AZURE_LIFECYCLE_ENABLED=false

# Move to cool tier after X days
STORAGE_AZURE_LIFECYCLE_COOL_AFTER_DAYS=30

# Move to archive tier after X days
STORAGE_AZURE_LIFECYCLE_ARCHIVE_AFTER_DAYS=90

# Delete after X days (2555 days = ~7 years)
STORAGE_AZURE_LIFECYCLE_DELETE_AFTER_DAYS=2555
