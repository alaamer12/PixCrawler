# =============================================================================
# AZURE PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy these to Azure Portal → Configuration → Application Settings
# For Azure App Service or Azure Container Apps deployment
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
ENVIRONMENT=production
DEBUG=false
HOST=0.0.0.0
PORT=8000
LOG_LEVEL=INFO
PIXCRAWLER_ENVIRONMENT=production

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Update with your actual frontend URLs
ALLOWED_ORIGINS=https://your-frontend.azurewebsites.net,https://your-custom-domain.com,https://app.pixcrawler.com

# -----------------------------------------------------------------------------
# Supabase Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# Get these from: https://app.supabase.com/project/_/settings/api
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
SUPABASE_ANON_KEY=your-anon-key-here

# -----------------------------------------------------------------------------
# Database Configuration (Supabase PostgreSQL)
# -----------------------------------------------------------------------------
# Get connection string from Supabase Dashboard → Settings → Database
DATABASE_URL=postgresql+asyncpg://postgres:password@db.your-project.supabase.co:5432/postgres
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# -----------------------------------------------------------------------------
# Redis Configuration (Local - running on same container)
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379/0
REDIS_EXPIRE_SECONDS=3600
REDIS_MAX_CONNECTIONS=50

# -----------------------------------------------------------------------------
# Celery Configuration (Local Redis)
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_EAGER_PROPAGATES=false

# -----------------------------------------------------------------------------
# File Upload Configuration
# -----------------------------------------------------------------------------
UPLOAD_MAX_SIZE=10485760
UPLOAD_ALLOWED_EXTENSIONS=.jpg,.jpeg,.png,.gif,.webp

# -----------------------------------------------------------------------------
# Storage Provider Configuration
# -----------------------------------------------------------------------------
# Options: local, azure
STORAGE_PROVIDER=azure

# =============================================================================
# AZURE BLOB STORAGE CONFIGURATION
# =============================================================================
# Get connection string from: Azure Portal → Storage Account → Access Keys
# Or use account name + key for more flexibility

# Connection Method 1: Connection String (Recommended)
AZURE_BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=YOUR_ACCOUNT;AccountKey=YOUR_KEY;EndpointSuffix=core.windows.net

# Connection Method 2: Account Name + Key (Alternative)
# AZURE_BLOB_ACCOUNT_NAME=pixcrawlerstorage
# AZURE_BLOB_ACCOUNT_KEY=your-account-key-here

# Container Configuration
AZURE_BLOB_CONTAINER_NAME=pixcrawler-datasets

# Performance Settings
AZURE_BLOB_MAX_RETRIES=3
AZURE_BLOB_TIMEOUT=300
AZURE_BLOB_MAX_SINGLE_GET_SIZE=33554432
AZURE_BLOB_MAX_CHUNK_GET_SIZE=4194304

# Access Tier Configuration
# Options: hot, cool, archive
AZURE_BLOB_DEFAULT_TIER=hot
AZURE_BLOB_ENABLE_ARCHIVE=true
AZURE_BLOB_REHYDRATE_PRIORITY=standard

# Lifecycle Management (Optional - Cost Optimization)
AZURE_BLOB_LIFECYCLE_ENABLED=false
AZURE_BLOB_LIFECYCLE_COOL_AFTER_DAYS=30
AZURE_BLOB_LIFECYCLE_ARCHIVE_AFTER_DAYS=90
AZURE_BLOB_LIFECYCLE_DELETE_AFTER_DAYS=2555

# SAS Token Configuration
AZURE_BLOB_SAS_TOKEN_EXPIRY_HOURS=1

# =============================================================================
# AZURE APP SERVICE CONFIGURATION
# =============================================================================
# These are typically auto-populated by Azure, but can be set manually

# App Service Identity
AZURE_APP_SERVICE_NAME=pixcrawler-backend
AZURE_APP_SERVICE_RESOURCE_GROUP=pixcrawler-rg
AZURE_APP_SERVICE_SUBSCRIPTION_ID=00000000-0000-0000-0000-000000000000
AZURE_APP_SERVICE_REGION=eastus

# App Service Plan
AZURE_APP_SERVICE_SKU=B1

# Runtime Configuration
AZURE_APP_SERVICE_WORKERS=4
AZURE_APP_SERVICE_TIMEOUT=300

# Feature Flags
AZURE_APP_SERVICE_ENABLE_REDIS=true
AZURE_APP_SERVICE_ENABLE_CELERY=true
AZURE_APP_SERVICE_CELERY_CONCURRENCY=2

# Logging
AZURE_APP_SERVICE_ENABLE_APPLICATION_LOGGING=true
AZURE_APP_SERVICE_LOG_LEVEL=INFO

# =============================================================================
# AZURE STATIC WEB APPS CONFIGURATION (Optional - for Next.js frontend)
# =============================================================================
# Alternative to Vercel for hosting Next.js frontend
# Only needed if deploying frontend to Azure instead of Vercel

# AZURE_STATIC_WEB_APP_NAME=pixcrawler-frontend
# AZURE_STATIC_WEB_APP_RESOURCE_GROUP=pixcrawler-rg
# AZURE_STATIC_WEB_APP_REGION=eastus2
# AZURE_STATIC_WEB_APP_SKU=Free
# AZURE_STATIC_WEB_APP_APP_LOCATION=/
# AZURE_STATIC_WEB_APP_OUTPUT_LOCATION=.next
# AZURE_STATIC_WEB_APP_CUSTOM_DOMAIN=app.pixcrawler.com

# =============================================================================
# AZURE APPLICATION INSIGHTS (Monitoring)
# =============================================================================
# Get from: Azure Portal → Application Insights → Properties
# Recommended for production monitoring

# Enable/Disable Monitoring
AZURE_MONITOR_ENABLED=true

# Connection String (Recommended)
AZURE_MONITOR_CONNECTION_STRING=InstrumentationKey=00000000-0000-0000-0000-000000000000;IngestionEndpoint=https://eastus-8.in.applicationinsights.azure.com/;LiveEndpoint=https://eastus.livediagnostics.monitor.azure.com/

# Instrumentation Key (Legacy - use connection string instead)
# AZURE_MONITOR_INSTRUMENTATION_KEY=00000000-0000-0000-0000-000000000000

# Telemetry Configuration
AZURE_MONITOR_SAMPLING_RATE=1.0
AZURE_MONITOR_LOG_LEVEL=WARNING

# Tracking Options
AZURE_MONITOR_TRACK_DEPENDENCIES=true
AZURE_MONITOR_TRACK_REQUESTS=true
AZURE_MONITOR_TRACK_EXCEPTIONS=true
AZURE_MONITOR_TRACK_EVENTS=true
AZURE_MONITOR_TRACK_METRICS=true

# Performance Settings
AZURE_MONITOR_FLUSH_INTERVAL_SECONDS=15
AZURE_MONITOR_MAX_BATCH_SIZE=100

# =============================================================================
# AZURE GLOBAL SETTINGS
# =============================================================================
# Azure AD Tenant ID (Optional - for advanced authentication)
# AZURE_TENANT_ID=00000000-0000-0000-0000-000000000000

# =============================================================================
# COST OPTIMIZATION NOTES
# =============================================================================
# 
# Blob Storage Tiers:
# - Hot: $0.018/GB/month - Immediate access, best for active datasets
# - Cool: $0.010/GB/month - 44% savings, 30-day minimum storage
# - Archive: $0.001/GB/month - 94% savings, 180-day minimum, 15hr rehydration
#
# Recommended Strategy:
# 1. Upload to Hot tier for immediate access
# 2. Move to Cool after 30 days (lifecycle policy)
# 3. Move to Archive after 90 days for long-term storage
# 4. Delete after 7 years (2555 days) for compliance
#
# Application Insights Sampling:
# - Set AZURE_MONITOR_SAMPLING_RATE=0.1 (10%) to reduce costs
# - Full sampling (1.0) recommended for initial deployment
# - Adjust based on traffic and budget
#
# =============================================================================